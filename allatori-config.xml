<?xml version="1.0" encoding="UTF-8"?>
<config>
    <!-- General run configuration -->
    <property name="log-file" value="build/obfuscation/allatori-log.xml"/>
    <property name="random-seed" value="godlike-20251018"/>
    <property name="version-marker" value="GODLIKE_OBF_2025"/>

    <!-- Core obfuscation features -->
    <!-- 禁用字符串加密，避免 Json/Gson 相关调用在解密桩里出现类型擦除 -->
    <property name="string-encryption" value="disable"/>
    <property name="string-encryption-ignored-strings" value="config/allatori-string-excludes.txt"/>
    <!-- Flow obfuscation disabled to avoid JVM verification issues observed with Gson calls -->
    <property name="control-flow-obfuscation" value="disable"/>
    <property name="extensive-flow-obfuscation" value="disable"/>
    <property name="packages-naming" value="custom(config/custom-packages.txt)"/>
    <property name="classes-naming" value="custom(config/custom-classes.txt)"/>
    <property name="methods-naming" value="custom(config/custom-methods.txt)"/>
    <property name="fields-naming" value="custom(config/custom-fields.txt)"/>
    <property name="local-variables-naming" value="keep"/>
    <property name="methods-naming-prefix" value="do"/>
    <property name="fields-naming-prefix" value="_"/>
    <property name="unique-renaming" value="enable"/>

    <!-- Metadata trimming -->
    <property name="line-numbers" value="obfuscate"/>
    <property name="generics" value="keep"/>
    <property name="inner-classes" value="keep"/>
    <property name="throws-clause" value="keep"/>
    <property name="member-reorder" value="random"/>
    <property name="synthetize-methods" value="disable"/>
    <property name="synthetize-fields" value="disable"/>
    <property name="remove-toString" value="disable"/>
    <property name="update-resource-names" value="disable"/>
    <property name="update-resource-contents" value="disable"/>

    <!-- Jar input/output -->
    <input basedir="build/libs">
        <jar in="SkyCore-deobf.jar" out="SkyCoreMod.jar"/>
    </input>
    <classpath>
        <jar name="E:/脚本/混淆/forge.jar"/>
        <jar name="E:/脚本/混淆/!mixinbooter-10.6.jar"/>
        <jar name="E:/脚本/混淆/gson.jar"/>
    </classpath>

    <keep-names>
        <!-- Godlike mod classes -->
        <class template="class org.mybad.minecraft.SkyCoreMod">
            <method template="*(**)"/>
            <field template="*"/>
        </class>
        <class template="class org.mybad.minecraft.SkyCoreLoadingPlugin">
            <method template="*(**)"/>
            <field template="*"/>
        </class>
        <class template="class org.mybad.minecraft.mixin.**">
            <method template="*(**)"/>
            <field template="*"/>
        </class>
        <class template="class com.google.**">
            <method template="*(**)"/>
            <field template="*"/>
        </class>
        <class template="class org.mybad.skycoreproto.**">
            <method template="*(**)"/>
            <field template="*"/>
        </class>
        <class template="class org.mybad.bedrockparticle.**">
            <method template="*(**)"/>
            <field template="*"/>
        </class>
    </keep-names>
    
</config>
