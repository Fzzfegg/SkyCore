<?xml version="1.0" encoding="UTF-8"?>
<config>
    <!-- General run configuration -->
    <property name="log-file" value="build/obfuscation/allatori-log.xml"/>
    <property name="random-seed" value="auto"/>
    <property name="version-marker" value="SKYCORE_OBF_2025"/>

    <!-- Core obfuscation features -->
    <!-- 启用字符串加密，依赖忽略列表避开 Json/Gson 相关调用 -->
    <property name="string-encryption" value="disable"/>
    <property name="string-encryption-ignored-strings" value="config/allatori-string-excludes.txt"/>
    <!-- Flow obfuscation disabled to avoid JVM verification issues observed with Gson calls -->
    <property name="control-flow-obfuscation" value="disable"/>
    <property name="extensive-flow-obfuscation" value="normal"/>
    <property name="packages-naming" value="custom(config/custom-packages.txt)"/>
    <property name="classes-naming" value="custom(config/custom-classes.txt)"/>
    <property name="methods-naming" value="custom(config/custom-methods.txt)"/>
    <property name="fields-naming" value="custom(config/custom-fields.txt)"/>
    <property name="local-variables-naming" value="abc"/>
    <property name="methods-naming-prefix" value="__"/>
    <property name="fields-naming-prefix" value="_"/>
    <property name="unique-renaming" value="enable"/>

    <!-- Metadata trimming -->
    <property name="line-numbers" value="remove"/>
<!--    不能开 开了会导致gltf不识别-->
<!--    <property name="generics" value="remove"/>-->
    <property name="inner-classes" value="remove"/>
    <property name="throws-clause" value="remove"/>
    
    <property name="member-reorder" value="random"/>
    <property name="synthetize-methods" value="disable"/>
    <property name="synthetize-fields" value="disable"/>
    <property name="remove-toString" value="disable"/>
<!--	<property name="update-resource-names"    value="disable"/>-->
<!--	<property name="update-resource-contents" value="disable"/>-->
    
    <!-- Jar input/output -->
    <input basedir="build/libs">
        <jar in="SkyCore-deobf.jar" out="SkyCoreMod.jar"/>
    </input>
    <classpath>
        <jar name="E:/脚本/混淆/forge.jar"/>
        <jar name="E:/脚本/混淆/!mixinbooter-10.6.jar"/>
        <jar name="E:/脚本/混淆/fasterxml-jackson-2.12.x.jar"/>
        <jar name="E:/脚本/混淆/gson.jar"/>
    </classpath>

    <ignore-classes>
		<class template="class org.spongepowered.**"/>
        <class template="class org.joml.**"/>
        <class template="class com.fasterxml.**"/>
        <class template="class org.mybad.skycoreproto.**"/>
        <class template="class com.google.**"/>
	</ignore-classes>

    
    <keep-names>
        <field  template="field_*"/>
		<method template="func_*(**)"/>
		<method template="toString()"/>
		<method template="hashCode()"/>
		<method template="equals(*)"/>
        <class template="class ** implements java.lang.annotation.Annotation"/>
        

        <class template="class org.mybad.minecraft.SkyCoreMod">
            <method template="*(**)"/>
            <field template="*"/>
        </class>
        <class template="class org.mybad.minecraft.SkyCoreLoadingPlugin">
            <method template="*(**)"/>
            <field template="*"/>
        </class>      
        
        <class template="class org.mybad.minecraft.resource.TextureReloadHelper">
            <method template="*(**)"/>
            <field template="*"/>
        </class>
        
        <class template="class org.mybad.minecraft.mixin.**">
            <method template="*(**)"/>
            <field template="*"/>
        </class>
        <class template="class org.mybad.skycoreproto.**">
            <method template="*(**)"/>
            <field template="*"/>
        </class>
        <class template="class org.mybad.bedrockparticle.**">
            <method template="*(**)"/>
            <field template="*"/>
        </class>      
        <class template="class org.mybad.minecraft.render.entity.EntityRenderPipeline">
            <method template="*(**)"/>
            <field template="*"/>
        </class>  
        <class template="class org.mybad.minecraft.render.ModelRenderPipeline">
            <method template="*(**)"/>
            <field template="*"/>
        </class>     
        <class template="class org.mybad.minecraft.render.BedrockModelWrapper">
            <method template="*(**)"/>
            <field template="*"/>
        </class>      
        <class template="class org.mybad.minecraft.render.entity.events">
            <method template="*(**)"/>
            <field template="*"/>
        </class>  
        
        <class template="class org.mybad.minecraft.gltf.jgltf.impl.**">
            <method template="*(**)"/>
            <field template="*"/>
        </class>
    </keep-names>
    
</config>
